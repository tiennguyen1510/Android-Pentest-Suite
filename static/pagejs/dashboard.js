/**
 * xu ly khi nhan nut ket noi voi dien thoai
 */
function doConect() {
    // phuong thuc dung de connect
    var metd = document.getElementById("cbMethod").value;
    var ip = document.getElementById("txtIp").value;
    var url = window.location.origin + "/scan/connect/" + metd + "/" + ip;
    
    // hide cac div o duoi    
    document.getElementById("divFailMess").style.display = "none";
    document.getElementById("divPhoneInfo").style.display = "none";

    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
            // JSON tra ve
            var result = JSON.parse(this.responseText);
            // ket qua ket noi
            var isSuccess = result.success;

            // khong thanh cong thi chi hien message
            if (!isSuccess) {
                document.getElementById("divFailMess").style.display = "block";
            } else {
                // thanh cong thi hien thi message va div thong tin co ban
                document.getElementById("divPhoneInfo").style.display = "block";

                // hien thi thong tin co ban cua dien thoai
                var phoneInfos = document.getElementById("phoneInfo").children;
                for (i = 0; i < 5; ++i) {
                    phoneInfos[i * 2 + 1].innerHTML = toUnknown(result.phone_infos[i]);
                }

                // hien thi danh sach ung dung
                var tblAppList = document.getElementById("tblAppList");
                for (i = 0; i < result.app_list.length; i++) {
                    var td1 = document.createElement('td');
                    td1.innerHTML = i + 1 +  ".";
                    var td2 = document.createElement('td');
                    td2.innerHTML = "<a href='scan/one/" + result.app_list[i]
                        + "'>" + result.app_list[i] + "</a>";
                    
                    var tr = document.createElement('tr');
                    tr.appendChild(td1);
                    tr.appendChild(td2);
                    tblAppList.appendChild(tr);
                }
            }
            console.log(result);
        }
    };
    xhttp.open("GET", url, true);
    xhttp.send();
}

function toUnknown(someString) {
    if (someString != "") return someString;
    return "Unknown";
}