{% extends 'base.html' %}
{% load static %}

{% block head %}
<title>Scan</title>
<!-- Tell the browser to be responsive to screen width -->
<link rel="stylesheet" href="{% static 'bower_components/bootstrap/dist/css/bootstrap.min.css' %}">
<!-- Font Awesome -->
<link rel="stylesheet" href="{% static 'bower_components/font-awesome/css/font-awesome.min.css' %}">
<!-- Ionicons -->
<link rel="stylesheet" href="{% static 'bower_components/Ionicons/css/ionicons.min.css' %}">
<!-- Theme style -->
<link rel="stylesheet" href="{% static 'dist/css/AdminLTE.min.css' %}">
<!-- AdminLTE Skins. -->
<link rel="stylesheet" href="{% static 'dist/css/skins/skin-blue.min.css' %}">
<!-- Google Font -->
<link rel="stylesheet" href="{% static 'dist/css/font.css' %}">
{% endblock head %}

{% block pageTitle %}Scan{% endblock pageTitle %}

{% block foot %}
<!-- jQuery 3 -->
<script src="{% static 'bower_components/jquery/dist/jquery.min.js' %}"></script>
<!-- Bootstrap 3.3.7 -->
<script src="{% static 'bower_components/bootstrap/dist/js/bootstrap.min.js' %}"></script>
<!-- AdminLTE App -->
<script src="{% static 'dist/js/adminlte.min.js' %}"></script>
<script src="{% static 'pagejs/scan_one.js' %}" type="text/javascript"></script>
{% endblock foot %}

{% block content %}
<div class="row">
    <section class="col-lg-12">
        <div class="box box-primary">
            <div class="box-header">
                <h3 class="box-title">{{ data.app_name }}</h3>
            </div>
            <div class="box-body">
                <table class="table">
                    <tbody id="tblAppList">
                        <tr>
                            <th style="width: 30px">#</th>
                            <th>Tools</th>
                        </tr>
                        {% for tool in data.toolList %}
                        <tr>
                            <form role="form" action="/scan/tool/{{ data.app_name }}/{{ forloop.counter0 }}">
                                <td><button type="submit" class="btn btn-default btn-xs">Scan</button></td>
                            </form>
                            <td>{{ tool }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            <div class="box-footer">
                <form role="form" action="/scan/all-tool/{{ data.app_name }}">
                    <button type="submit" class="btn btn-danger buttonload" onclick="">
                        <i class="fa fa-search-plus"></i> Use all tools</button>
                    <button type="button" class="btn btn-info"
                        onclick="window.location.href = '/report/view/{{ data.app_name }}';">
                        <i class="fa fa-line-chart"></i> View report</button>
                </form>
            </div>
        </div>
    </section>
</div>

<div class="row" style="display: block;">
    <section class="col-lg-12">
        <div class="box box-primary">
            <div class="box-header">
                <div class="pull-right box-tools">
                    <button type="button" class="btn btn-primary btn-sm pull-right" data-widget="collapse"
                        data-toggle="tooltip" title="" style="margin-right: 5px;" data-original-title="Collapse">
                        <i class="fa fa-minus"></i></button>
                </div>
                <h3 class="box-title">Qark report</h3>
            </div>
            <div class="box-body">
                <div class="box-group" id="accordion">
                    {% for qark_report in data.qark_reports %}
                    <div class="panel box box-primary">
                        <div class="box-header">
                            <h4 class="box-title">
                                {{ qark_report.file_object }}
                            </h4>
                        </div>
                        <div id="collapseOne" class="panel-collapse collapse in">
                            <div class="box-body">
                                <dl>
                                    <dt>Content: {{ qark_report.name }}</dt>
                                    <dt>Severity: {{ qark_report.severity }}</dt>
                                    <dt>Description:</dt>
                                    <dd>{{ qark_report.description }}</dd>
                                </dl>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div><!-- /.qark-body -->

        <div class="box box-primary">
            <div class="box-header">
                <div class="pull-right box-tools">
                    <button type="button" class="btn btn-primary btn-sm pull-right" data-widget="collapse"
                        data-toggle="tooltip" title="" style="margin-right: 5px;" data-original-title="Collapse">
                        <i class="fa fa-minus"></i></button>
                </div>
                <h3 class="box-title">Dependency Check report</h3>
            </div>
            <div class="box-body">
                <div class="box-group" id="accordion">
                    {% for qark_report in data.dc_reports %}
                    <div class="panel box box-primary">
                        <div class="box-header">
                            <h4 class="box-title">
                                {{ qark_report.file_object }}
                            </h4>
                        </div>
                        <div id="collapseOne" class="panel-collapse collapse in">
                            <div class="box-body">
                                <dl>
                                    <dt>Content: {{ qark_report.name }}</dt>
                                    <dt>Severity: {{ qark_report.severity }}</dt>
                                    <dt>Description:</dt>
                                    <dd>{{ qark_report.description }}</dd>
                                </dl>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div><!-- /.dc-body -->

        <div class="box box-primary">
            <div class="box-header">
                <div class="pull-right box-tools">
                    <button type="button" class="btn btn-primary btn-sm pull-right" data-widget="collapse"
                        data-toggle="tooltip" title="" style="margin-right: 5px;" data-original-title="Collapse">
                        <i class="fa fa-minus"></i></button>
                </div>
                <h3 class="box-title">Sniffgit report</h3>
            </div>
            <div class="box-body">
                <div class="box-group" id="accordion">
                    {% for sniffgit_report in data.sniffgit_reports %}
                    <div class="panel box box-primary">
                        <div class="box-header">
                            <h4 class="box-title">
                                {{ sniffgit_report.file_name }}
                            </h4>
                        </div>
                        <div id="collapseOne" class="panel-collapse collapse in">
                            <div class="box-body">
                                {% for description in sniffgit_report.description_list %}
                                {% if description %}
                                <p>{{ description }};</p>
                                {% endif %}
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div><!-- /.sniffgit-body -->

        <div class="box box-primary">
            <div class="box-header">
                <div class="pull-right box-tools">
                    <button type="button" class="btn btn-primary btn-sm pull-right" data-widget="collapse"
                        data-toggle="tooltip" title="" style="margin-right: 5px;" data-original-title="Collapse">
                        <i class="fa fa-minus"></i></button>
                </div>
                <h3 class="box-title">Andro report</h3>
            </div>
            <div class="box-body">
                <pre>{{ data.andro_reports }}</pre>
            </div>
        </div><!-- /.andro-body -->
    </section>
</div>
{% endblock content %}